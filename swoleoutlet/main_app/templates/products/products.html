{% extends 'base.html' %} {% block content %}

<h1>Product List</h1>
<div class = "container">

{% for product in products %}


<div id="{{product.id}}" class="card">
  <div class="card-content">
    <span
      class="card-title product-name"
      id="product-name"
      data-product="{{product.id}}"
      >{{product.name}}</span
    >
    <p hidden id="product-id" data-product="{{product.id}}" class="product-id">
      {{product.id}}
    </p>
    <p id="product-type" data-product="{{product.id}}" class="product-type">
      {{product.product_type}}
    </p>
    <p>Price:<p id="product-price" data-product="{{product.id}}" class="product-price">
      {{product.price}}
    </p></p>
    <!-- <p id="product-quantity" class="product-quantity">
      Quantity: {{ product.quantity_available }}
    </p> -->
    <p id="product-description" class="product-description">
      Description: {{ product.product_description }}
    </p>

    <button class="increment">+</button><input type="number" /><button
      class="decrement"
    >
      -
    </button>
    <button data-product="{{product.id}}" class="add-to-cart">
      Add to cart
    </button>
    <button class="view-cart">
      View Cart
    </button>
  </div>
</div>

<script>


  let addCart = document.querySelector(".container");
  let viewCart = document.querySelector("view-cart");

  addCart.addEventListener("click", function (e) {
    let productId = e.target.getAttribute("data-product");
    let productArray = document.querySelectorAll(`[data-product~="${productId}"]`)

    let cartObj = {
      id: productArray[0].innerHTML.trim(),
      name: productArray[1].innerHTML.trim(),
      type: productArray[2].innerHTML.trim(),
      price: parseInt(productArray[3].innerHTML.trim()),
    }
    
    let cart = []
    cart.push(cartObj); 

    
    let jsonCart = JSON.stringify(cart);
    localStorage.setItem("cart", jsonCart);
    
    //create a js file, have table row. document.createelment(td) save that to a variable. 
  });

</script>

{% endfor %} 
</div>
{% endblock %}
