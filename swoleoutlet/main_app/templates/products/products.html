{% extends 'base.html' %} {% block content %}

<h1>Product List</h1>
<div class = "container">

{% for product in products %}


<div id="{{product.id}}" class="card">
  <div class="card-content">
    <span
      class="card-title product-name"
      id="product-name"
      data-product="{{product.id}}"
      >{{product.name}}</span
    >
    <p hidden id="product-id" data-product="{{product.id}}" class="product-id">
      {{product.id}}
    </p>
    <p id="product-type" data-product="{{product.id}}" class="product-type">
      {{product.product_type}}
    </p>
    <p>Price:<p id="product-price" data-product="{{product.id}}" class="product-price">
      {{product.price}}
    </p></p><
    <!-- <p id="product-quantity" class="product-quantity">
      Quantity: {{ product.quantity_available }}
    </p> -->
    <p id="product-description" class="product-description">
      Description: {{ product.product_description }}
    </p>

    <button class="increment">+</button><input type="number" /><button
      class="decrement"
    >
      -
    </button>
    <button data-product="{{product.id}}" class="add-to-cart">
      Add to cart
    </button>
    <button class="view-cart">
      View Cart
    </button>
  </div>
</div>

<script>
  let productId = parseInt(document.getElementById("product-id").textContent.trim());
  let productName = document.getElementById("product-name").textContent.trim();
  let productType = document.getElementById("product-type").textContent.trim();
  let productPrice = parseInt(document
    .getElementById("product-price")
    .textContent.trim());
    
  let cartObj = {
    id: productId,
    name: productName,
    type: productType,
    price: productPrice,
    quantity: 0,
  };
  let cart = [];
  console.log(cartObj);

  let addCart = document.querySelector(".container");
   //look up dynamic event listeners (event delegation)
  let viewCart = document.querySelector("view-cart");

  addCart.addEventListener("click", function (e) {
    if (e.target.classList.contains("add-to-cart")) {
      cart.push(cartObj);
      cartObj.quantity++;
      localStorage.setItem("setObject", JSON.stringify(cartObj));
    } 
    console.log(e.target.classList.contains("add-to-cart"));
    console.log(e.target.dataset);
    
  });

  viewCart.addEventListener("click", function () {
    let getObject = localStorage.getItem("setObject");
    console.log("retrievedObject: ", JSON.parse(getObject));
  });
</script>

{% endfor %} 
</div>
{% endblock %}
