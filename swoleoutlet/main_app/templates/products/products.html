{% extends 'base.html' %} {% block content %}
<h1>
  <img src="../static/images/swoledoge.jpeg" width="7%" height="7%" /> Product
  List
</h1>
<hr />

<div class="container">
  {% for product in products %}
  <div class="column">
    {% if product.image %}
    <img src="{{product.image.url}}" width="30%" height="30%"/>
    {% endif %}
    <!-- <div class="card">
        <div class="card-content"> -->
    <!-- <span class="card-title">{{ product.name }}</span> -->
    <!-- <p>{{ product.name }}</br>{{ product.product_description }}</br> ${{ product.price }} </p> -->
  <ul>
    <li><p hidden id="product-id" data-product="{{product.id}}" class="product-id">
      {{product.id}}
      </p></li>
      <li><p id="product-name" data-product="{{product.id}}" class="product-name">
      {{product.name}}
      </p></li>
      <li><p hidden id="product-type" data-product="{{product.id}}" class="product-type">
      {{product.product_type}}
      </p></li>
      <li><p id="product-price" data-product="{{product.id}}" class="product-price">
     $ {{product.price}}
      </p></li>
    <li><p id="product-description" class="product-description">
      Description: {{ product.product_description }}
    </p></li>
    <li><a href="/orders"><button class="btn-review">
      Review
    </button></a></li>
  </ul>
    <!-- </div>
      </div> -->
        <!-- <input type="submit" class="btn-add" value="Add To Cart" /> -->
        <button data-product="{{product.id}}" class="btn-add">
          Add to cart
        </button>
        <a href="/cart"><button class="view-cart">
          View Cart
        </button></a>
  </div>
</br>
</div>
{% endfor %} 
<script>
  let addCart = document.querySelector(".container");
   //look up dynamic event listeners (event delegation)
  let viewCart = document.querySelector("view-cart");
  addCart.addEventListener("click", function (e) {
    let productId = e.target.getAttribute("data-product");
    let productArray = document.querySelectorAll(`[data-product~="${productId}"]`)
    let cartObj = {
      id: productArray[0].innerHTML.trim(),
      name: productArray[1].innerHTML.trim(),
      type: productArray[2].innerHTML.trim(),
      price: parseInt(productArray[3].innerHTML.trim()),
    }
    console.log(cartObj)
    jsonCart = JSON.stringify(cartObj);
    localStorage.setItem("cart", jsonCart);
  });
</script>
{% endblock %}

